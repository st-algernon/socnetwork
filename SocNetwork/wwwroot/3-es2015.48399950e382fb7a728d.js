(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{dlKe:function(t,e,n){"use strict";n.d(e,"a",function(){return D}),n.d(e,"b",function(){return K});var i=n("fXoL"),o=n("LRne"),s=n("xgIS"),r=n("5+tZ"),l=n("lJxs"),a=n("vkgz"),c=n("pLZG"),u=n("7o/Q"),h=n("D0XW");n("zx2A");const d={leading:!0,trailing:!1};class p{constructor(t,e,n,i){this.duration=t,this.scheduler=e,this.leading=n,this.trailing=i}call(t,e){return e.subscribe(new f(t,this.duration,this.scheduler,this.leading,this.trailing))}}class f extends u.a{constructor(t,e,n,i,o){super(t),this.duration=e,this.scheduler=n,this.leading=i,this.trailing=o,this._hasTrailingValue=!1,this._trailingValue=null}_next(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(g,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))}_complete(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()}clearThrottle(){const t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)}}function g(t){const{subscriber:e}=t;e.clearThrottle()}function b(t,e,n,i){const o=window&&!!window.document&&window.document.documentElement;let s=o&&e?window:n;if(t&&(s=t&&o&&"string"==typeof t?function(t,e,n){return(n?window.document:e).querySelector(t)}(t,n.nativeElement,i):t,!s))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return s}function m(t){return t&&!t.firstChange}const w={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},S={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"};class O{constructor(t=!0){this.vertical=t,this.propsMap=t?w:S}clientHeightKey(){return this.propsMap.clientHeight}offsetHeightKey(){return this.propsMap.offsetHeight}scrollHeightKey(){return this.propsMap.scrollHeight}pageYOffsetKey(){return this.propsMap.pageYOffset}offsetTopKey(){return this.propsMap.offsetTop}scrollTopKey(){return this.propsMap.scrollTop}topKey(){return this.propsMap.top}}function x(t){return["Window","global"].some(e=>Object.prototype.toString.call(t).includes(e))}function P(t,e){return t?e.document.documentElement:null}function v(t,e){const n=function({container:t,isWindow:e,axis:n}){const{offsetHeightKey:i,clientHeightKey:o}=T(n);return y(t,e,i,o)}(e);return e.isWindow?function(t,e,n){const{axis:i,container:o,isWindow:s}=n,{offsetHeightKey:r,clientHeightKey:l}=T(i),a=t+C(P(s,o),i,s),c=y(e.nativeElement,s,r,l);return{height:t,scrolled:a,totalToScroll:function(t,e,n){const i=e.topKey();if(t.getBoundingClientRect)return t.getBoundingClientRect()[i]+C(t,e,n)}(e.nativeElement,i,s)+c,isWindow:s}}(n,t,e):function(t,e,n){const{axis:i,container:o}=n;return{height:t,scrolled:o[i.scrollTopKey()],totalToScroll:o[i.scrollHeightKey()],isWindow:!1}}(n,0,e)}function T(t){return{offsetHeightKey:t.offsetHeightKey(),clientHeightKey:t.clientHeightKey()}}function y(t,e,n,i){if(isNaN(t[n])){const n=P(e,t);return n?n[i]:0}return t[n]}function C(t,e,n){const i=e.pageYOffsetKey(),o=e.scrollTopKey(),s=e.offsetTopKey();return isNaN(window.pageYOffset)?P(n,t)[o]:t.ownerDocument?t.ownerDocument.defaultView[i]:t[s]}function _(t,e,n){let i,o;if(t.totalToScroll<=0)return!1;const s=t.isWindow?t.scrolled:t.height+t.scrolled;return n?(i=(t.totalToScroll-s)/t.totalToScroll,o=e.down/10):(i=t.scrolled/(t.scrolled+(t.totalToScroll-s)),o=e.up/10),i<=o}class k{constructor({totalToScroll:t}){this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},this.totalToScroll=t}updateScrollPosition(t){return this.lastScrollPosition=t}updateTotalToScroll(t){this.lastTotalToScroll!==t&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=t)}updateScroll(t,e){this.updateScrollPosition(t),this.updateTotalToScroll(e)}updateTriggeredFlag(t,e){e?this.triggered.down=t:this.triggered.up=t}isTriggeredScroll(t,e){return e?this.triggered.down===t:this.triggered.up===t}}function M(t){const{scrollDown:e,stats:{scrolled:n}}=t;return{type:e?"[NGX_ISE] DOWN":"[NGX_ISE] UP",payload:{currentScrollPosition:n}}}let D=(()=>{class t{constructor(t,e){this.element=t,this.zone=e,this.scrolled=new i.n,this.scrolledUp=new i.n,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}ngAfterViewInit(){this.infiniteScrollDisabled||this.setup()}ngOnChanges({infiniteScrollContainer:t,infiniteScrollDisabled:e,infiniteScrollDistance:n}){const i=m(t),o=m(e),s=m(n),r=!o&&!this.infiniteScrollDisabled||o&&!e.currentValue||s;(i||o||s)&&(this.destroyScroller(),r&&this.setup())}setup(){"undefined"!=typeof window&&this.zone.runOutsideAngular(()=>{this.disposeScroller=function(t){const{scrollContainer:e,scrollWindow:n,element:i,fromRoot:u}=t,f=function({windowElement:t,axis:e}){return function(t,e){const n=t.isWindow||e&&!e.nativeElement?e:e.nativeElement;return Object.assign(Object.assign({},t),{container:n})}({axis:e,isWindow:x(t)},t)}({axis:new O(!t.horizontal),windowElement:b(e,n,i,u)}),g=new k({totalToScroll:v(i,f)}),m={up:t.upDistance,down:t.downDistance};return function(t){let e=Object(s.a)(t.container,"scroll");return t.throttle&&(e=e.pipe(function(t,e=h.a,n=d){return i=>i.lift(new p(t,e,n.leading,n.trailing))}(t.throttle))),e}({container:f.container,throttle:t.throttle}).pipe(Object(r.a)(()=>Object(o.a)(v(i,f))),Object(l.a)(t=>function(t,e,n){const{scrollDown:i,fire:o}=function(t,e,n){const i=function(t,e){return t<e.scrolled}(t,e);return{fire:_(e,n,i),scrollDown:i}}(t,e,n);return{scrollDown:i,fire:o,stats:e}}(g.lastScrollPosition,t,m)),Object(a.a)(({stats:t})=>g.updateScroll(t.scrolled,t.totalToScroll)),Object(c.a)(({fire:e,scrollDown:n,stats:{totalToScroll:i}})=>function(t,e,n){return!(!t||!e)||!(n||!e)}(t.alwaysCallback,e,g.isTriggeredScroll(i,n))),Object(a.a)(({scrollDown:t,stats:{totalToScroll:e}})=>{g.updateTriggeredFlag(e,t)}),Object(l.a)(M))}({fromRoot:this.fromRoot,alwaysCallback:this.alwaysCallback,disable:this.infiniteScrollDisabled,downDistance:this.infiniteScrollDistance,element:this.element,horizontal:this.horizontal,scrollContainer:this.infiniteScrollContainer,scrollWindow:this.scrollWindow,throttle:this.infiniteScrollThrottle,upDistance:this.infiniteScrollUpDistance}).subscribe(t=>this.zone.run(()=>this.handleOnScroll(t)))})}handleOnScroll({type:t,payload:e}){switch(t){case"[NGX_ISE] DOWN":return this.scrolled.emit(e);case"[NGX_ISE] UP":return this.scrolledUp.emit(e);default:return}}ngOnDestroy(){this.destroyScroller()}destroyScroller(){this.disposeScroller&&this.disposeScroller.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(i.Kb(i.l),i.Kb(i.A))},t.\u0275dir=i.Fb({type:t,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},features:[i.xb]}),t})(),K=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.Ib({type:t}),t.\u0275inj=i.Hb({providers:[],imports:[[]]}),t})()},xzSE:function(t,e,n){"use strict";n.d(e,"a",function(){return p});var i=n("fXoL"),o=n("yvDh"),s=n("XNvU"),r=n("tyNb"),l=n("ofXK"),a=n("3Pt+"),c=n("Sqts");function u(t,e){if(1&t&&i.Lb(0,"img",19),2&t){const t=i.Yb();i.dc("src",t.me.avatarPath,i.mc)}}function h(t,e){1&t&&i.Lb(0,"img",20)}function d(t,e){if(1&t){const t=i.Qb();i.Pb(0,"div",21),i.Pb(1,"div",22),i.Pb(2,"div",23),i.Wb("click",function(){return i.lc(t),i.Yb().unPreviewImages()}),i.Ob(),i.Lb(3,"app-photos-container",24),i.Ob(),i.Ob()}if(2&t){const t=i.Yb();i.zb(3),i.dc("photos",t.previewFiles)}}let p=(()=>{class t{constructor(t,e,n){this.postsService=t,this.mediaService=e,this.router=n,this.newPostEvent=new i.n,this.isValid=!1,this.previewFiles=[],this.subs=[],this.postForm={text:"",images:[]}}ngOnInit(){}ngOnDestroy(){this.subs.forEach(t=>{console.log("unsubs"),t.unsubscribe()})}resizeTextarea(t){const e=t.target;e.style.height="auto",e.style.height=e.scrollHeight+"px"}onEnterSubmit(t,e){"Enter"!=e.key||e.shiftKey||(e.preventDefault(),this.onSubmit(t))}onSubmit(t){const e={text:this.postForm.text,mediaDTOs:[]};if(0!=this.postForm.images.length){const t=new FormData;[...this.postForm.images].forEach((e,n)=>{t.set("file"+n,e,e.name)}),this.mediaService.uploadMedia(t).subscribe(t=>{e.mediaDTOs=t,console.log(t),this.subs.push(this.postsService.savePost(e).subscribe(t=>{this.newPostEvent.emit(t)})),this.previewFiles=[]})}else this.postForm.text&&this.subs.push(this.postsService.savePost(e).subscribe(t=>{this.newPostEvent.emit(t)}));this.postForm={text:"",images:[]}}previewImages(t){this.postForm.images=t,this.previewFiles=[];for(let e of t)if(e.type.match("image*")){const t=new FileReader;t.onload=t=>{this.previewFiles.push({id:e.name,mimeType:e.type,path:t.target.result.toString(),size:e.size,creationDate:new Date(e.lastModified)})},t.readAsDataURL(e)}}unPreviewImages(t){this.postForm.images=[],this.previewFiles=[]}}return t.\u0275fac=function(e){return new(e||t)(i.Kb(s.a),i.Kb(o.a),i.Kb(r.b))},t.\u0275cmp=i.Eb({type:t,selectors:[["app-post-maker"]],inputs:{me:"me"},outputs:{newPostEvent:"newPostEvent"},decls:21,vars:5,consts:[[1,"post-maker","flex","fd-r","jc-sb","ai-fs"],[1,"avatar-box","square-48"],["class","square-48","alt","photo",3,"src",4,"ngIf","ngIfElse"],["default_avatar",""],[3,"ngSubmit"],["form","ngForm"],["rows","1","name","postText","placeholder","\u0429\u043e \u043d\u043e\u0432\u043e\u0433\u043e?",3,"ngModel","input","ngModelChange"],["class","flex jc-c",4,"ngIf"],[1,"post-maker-footer","flex","ai-fe","jc-sb"],[1,"attach","flex","fd-r","jc-sb"],[1,"add-picture-btn","round","r-20","square-28",3,"click"],["type","file","name","postImages","ngModel","","multiple","",1,"hidden",3,"change"],["input_image",""],[1,"add-music-btn","round","r-20","square-28"],["type","file","name","music",1,"hidden"],[1,"add-video-btn","round","r-22","square-28"],["type","file","name","video",1,"hidden"],[1,"add-emoji-btn","round","r-22","square-28"],["type","submit",1,"submit-btn",3,"disabled"],["alt","photo",1,"square-48",3,"src"],["src","../../../../assets/images/default-avatar.jpg","alt","default-avatar",1,"square-48"],[1,"flex","jc-c"],[1,"preview-container","fg-1"],[1,"close-btn","round","r-16","square-20",3,"click"],["size","large",3,"photos"]],template:function(t,e){if(1&t){const t=i.Qb();i.Pb(0,"section",0),i.Pb(1,"span",1),i.oc(2,u,1,1,"img",2),i.oc(3,h,1,0,"ng-template",null,3,i.pc),i.Ob(),i.Pb(5,"form",4,5),i.Wb("ngSubmit",function(){i.lc(t);const n=i.kc(6);return e.onSubmit(n)}),i.Pb(7,"textarea",6),i.Wb("input",function(t){return e.resizeTextarea(t)})("ngModelChange",function(t){return e.postForm.text=t}),i.Ob(),i.oc(8,d,4,1,"div",7),i.Pb(9,"div",8),i.Pb(10,"ul",9),i.Pb(11,"li",10),i.Wb("click",function(){return i.lc(t),i.kc(13).click()}),i.Pb(12,"input",11,12),i.Wb("change",function(){i.lc(t);const n=i.kc(13);return e.previewImages(n.files)}),i.Ob(),i.Ob(),i.Pb(14,"li",13),i.Lb(15,"input",14),i.Ob(),i.Pb(16,"li",15),i.Lb(17,"input",16),i.Ob(),i.Lb(18,"li",17),i.Ob(),i.Pb(19,"button",18),i.qc(20,"\u041e\u043f\u0443\u0431\u043b\u0456\u043a\u0443\u0432\u0430\u0442\u0438"),i.Ob(),i.Ob(),i.Ob(),i.Ob()}if(2&t){const t=i.kc(4);i.zb(2),i.dc("ngIf",e.me.avatarPath)("ngIfElse",t),i.zb(5),i.dc("ngModel",e.postForm.text),i.zb(1),i.dc("ngIf",e.previewFiles.length>0),i.zb(11),i.dc("disabled",!e.postForm.text&&0==e.postForm.images.length)}},directives:[l.k,a.p,a.i,a.j,a.a,a.h,a.k,c.a],styles:[".post-maker[_ngcontent-%COMP%]{margin:15px 0 10px;padding:12px 16px;border-radius:15px;color:#272727;background:#fff}.post-maker[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{flex-basis:624px}.post-maker[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{margin-top:14px;font-size:18px;height:22px}.post-maker[_ngcontent-%COMP%]   .media-box[_ngcontent-%COMP%]{max-height:420px;border-radius:15px;overflow:hidden;margin:15px 0}.post-maker[_ngcontent-%COMP%]   .media-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:cover;object-fit:cover;-o-object-position:center;object-position:center;width:40%;max-height:210px;flex-grow:1;margin:0 2px 2px 0}.post-maker[_ngcontent-%COMP%]   .media-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:first-of-type{max-height:420px}.post-maker[_ngcontent-%COMP%]   .avatar-box[_ngcontent-%COMP%]{margin-right:10px;background:#eee}.post-maker[_ngcontent-%COMP%]   .post-maker-footer[_ngcontent-%COMP%]{flex-grow:1}.post-maker[_ngcontent-%COMP%]   .post-maker-footer[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]{border:none;color:#fff;padding:8px 11px;border-radius:20px;font-weight:700;font-size:15px;outline:none;cursor:pointer;background-color:#3eb2fa}.post-maker[_ngcontent-%COMP%]   .post-maker-footer[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]:disabled{background-color:#a7d9f8;cursor:auto}.attach[_ngcontent-%COMP%]{list-style:none}.attach[_ngcontent-%COMP%]   .add-picture-btn[_ngcontent-%COMP%]{background-image:url(picture.8bab62ef09da605e0ddf.png)}.attach[_ngcontent-%COMP%]   .add-music-btn[_ngcontent-%COMP%]{background-image:url(add-music.9a4176a08125a911c279.png)}.attach[_ngcontent-%COMP%]   .add-video-btn[_ngcontent-%COMP%]{background-image:url(add-video.07c28269d0df8adddcda.png)}.attach[_ngcontent-%COMP%]   .add-emoji-btn[_ngcontent-%COMP%]{position:relative;background-image:url(emoji.a281a630f75958ce1961.png)}.preview-container[_ngcontent-%COMP%]{position:relative;margin:5px 0}.preview-container[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{position:absolute;right:5px;top:5px;background-image:url(plus-hover.c5a44e580f069dae6603.png);background-color:#fff;transform:rotate(45deg);border:1px solid #eee;outline:none;z-index:10}"]}),t})()}}]);