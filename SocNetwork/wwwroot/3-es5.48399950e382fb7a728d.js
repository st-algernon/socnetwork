!function(){function t(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||e(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){if(t){if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function i(t,e){return(i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function o(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,i=l(t);if(e){var o=l(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return r(this,n)}}function r(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{dlKe:function(t,e,n){"use strict";n.d(e,"a",function(){return z}),n.d(e,"b",function(){return F});var r=n("fXoL"),l=n("LRne"),s=n("xgIS"),u=n("5+tZ"),f=n("lJxs"),d=n("vkgz"),p=n("pLZG"),h=n("7o/Q"),g=n("D0XW");n("zx2A");var b={leading:!0,trailing:!1},m=function(){function t(e,n,i,o){a(this,t),this.duration=e,this.scheduler=n,this.leading=i,this.trailing=o}return c(t,[{key:"call",value:function(t,e){return e.subscribe(new v(t,this.duration,this.scheduler,this.leading,this.trailing))}}]),t}(),v=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)}(n,t);var e=o(n);function n(t,i,o,r,l){var s;return a(this,n),(s=e.call(this,t)).duration=i,s.scheduler=o,s.leading=r,s.trailing=l,s._hasTrailingValue=!1,s._trailingValue=null,s}return c(n,[{key:"_next",value:function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(y,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))}},{key:"_complete",value:function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()}},{key:"clearThrottle",value:function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)}}]),n}(h.a);function y(t){t.subscriber.clearThrottle()}function w(t,e,n,i){var o=window&&!!window.document&&window.document.documentElement,r=o&&e?window:n;if(t&&!(r=t&&o&&"string"==typeof t?function(t,e,n){return(n?window.document:e).querySelector(t)}(t,n.nativeElement,i):t))throw new Error("ngx-infinite-scroll {resolveContainerElement()}: selector for");return r}function S(t){return t&&!t.firstChange}var O={clientHeight:"clientHeight",offsetHeight:"offsetHeight",scrollHeight:"scrollHeight",pageYOffset:"pageYOffset",offsetTop:"offsetTop",scrollTop:"scrollTop",top:"top"},k={clientHeight:"clientWidth",offsetHeight:"offsetWidth",scrollHeight:"scrollWidth",pageYOffset:"pageXOffset",offsetTop:"offsetLeft",scrollTop:"scrollLeft",top:"left"},x=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];a(this,t),this.vertical=e,this.propsMap=e?O:k}return c(t,[{key:"clientHeightKey",value:function(){return this.propsMap.clientHeight}},{key:"offsetHeightKey",value:function(){return this.propsMap.offsetHeight}},{key:"scrollHeightKey",value:function(){return this.propsMap.scrollHeight}},{key:"pageYOffsetKey",value:function(){return this.propsMap.pageYOffset}},{key:"offsetTopKey",value:function(){return this.propsMap.offsetTop}},{key:"scrollTopKey",value:function(){return this.propsMap.scrollTop}},{key:"topKey",value:function(){return this.propsMap.top}}]),t}();function P(t){return["Window","global"].some(function(e){return Object.prototype.toString.call(t).includes(e)})}function T(t,e){return t?e.document.documentElement:null}function _(t,e){var n,i,o,r,l=(i=(n=e).container,o=n.isWindow,r=C(n.axis),M(i,o,r.offsetHeightKey,r.clientHeightKey));return e.isWindow?function(t,e,n){var i=n.axis,o=n.container,r=n.isWindow,l=C(i),a=l.offsetHeightKey,s=l.clientHeightKey,c=t+D(T(r,o),i,r),u=M(e.nativeElement,r,a,s);return{height:t,scrolled:c,totalToScroll:function(t,e,n){var i=e.topKey();if(t.getBoundingClientRect)return t.getBoundingClientRect()[i]+D(t,e,n)}(e.nativeElement,i,r)+u,isWindow:r}}(l,t,e):function(t,e,n){var i=n.axis,o=n.container;return{height:t,scrolled:o[i.scrollTopKey()],totalToScroll:o[i.scrollHeightKey()],isWindow:!1}}(l,0,e)}function C(t){return{offsetHeightKey:t.offsetHeightKey(),clientHeightKey:t.clientHeightKey()}}function M(t,e,n,i){if(isNaN(t[n])){var o=T(e,t);return o?o[i]:0}return t[n]}function D(t,e,n){var i=e.pageYOffsetKey(),o=e.scrollTopKey(),r=e.offsetTopKey();return isNaN(window.pageYOffset)?T(n,t)[o]:t.ownerDocument?t.ownerDocument.defaultView[i]:t[r]}function j(t,e,n){var i,o;if(t.totalToScroll<=0)return!1;var r=t.isWindow?t.scrolled:t.height+t.scrolled;return n?(i=(t.totalToScroll-r)/t.totalToScroll,o=e.down/10):(i=t.scrolled/(t.scrolled+(t.totalToScroll-r)),o=e.up/10),i<=o}var E=function(){function t(e){var n=e.totalToScroll;a(this,t),this.lastScrollPosition=0,this.lastTotalToScroll=0,this.totalToScroll=0,this.triggered={down:0,up:0},this.totalToScroll=n}return c(t,[{key:"updateScrollPosition",value:function(t){return this.lastScrollPosition=t}},{key:"updateTotalToScroll",value:function(t){this.lastTotalToScroll!==t&&(this.lastTotalToScroll=this.totalToScroll,this.totalToScroll=t)}},{key:"updateScroll",value:function(t,e){this.updateScrollPosition(t),this.updateTotalToScroll(e)}},{key:"updateTriggeredFlag",value:function(t,e){e?this.triggered.down=t:this.triggered.up=t}},{key:"isTriggeredScroll",value:function(t,e){return e?this.triggered.down===t:this.triggered.up===t}}]),t}();function K(t){return{type:t.scrollDown?"[NGX_ISE] DOWN":"[NGX_ISE] UP",payload:{currentScrollPosition:t.stats.scrolled}}}var H,W,z=((W=function(){function t(e,n){a(this,t),this.element=e,this.zone=n,this.scrolled=new r.n,this.scrolledUp=new r.n,this.infiniteScrollDistance=2,this.infiniteScrollUpDistance=1.5,this.infiniteScrollThrottle=150,this.infiniteScrollDisabled=!1,this.infiniteScrollContainer=null,this.scrollWindow=!0,this.immediateCheck=!1,this.horizontal=!1,this.alwaysCallback=!1,this.fromRoot=!1}return c(t,[{key:"ngAfterViewInit",value:function(){this.infiniteScrollDisabled||this.setup()}},{key:"ngOnChanges",value:function(t){var e=t.infiniteScrollContainer,n=t.infiniteScrollDisabled,i=t.infiniteScrollDistance,o=S(e),r=S(n),l=S(i),a=!r&&!this.infiniteScrollDisabled||r&&!n.currentValue||l;(o||r||l)&&(this.destroyScroller(),a&&this.setup())}},{key:"setup",value:function(){var t=this;"undefined"!=typeof window&&this.zone.runOutsideAngular(function(){var e,n,i,o,r,a,c,h,v,y,S,O;t.disposeScroller=(e={fromRoot:t.fromRoot,alwaysCallback:t.alwaysCallback,disable:t.infiniteScrollDisabled,downDistance:t.infiniteScrollDistance,element:t.element,horizontal:t.horizontal,scrollContainer:t.infiniteScrollContainer,scrollWindow:t.scrollWindow,throttle:t.infiniteScrollThrottle,upDistance:t.infiniteScrollUpDistance},a=e.scrollContainer,c=e.scrollWindow,h=e.element,v=e.fromRoot,y=function(t,e){var n=t.isWindow||e&&!e.nativeElement?e:e.nativeElement;return Object.assign(Object.assign({},t),{container:n})}({axis:(n={axis:new x(!e.horizontal),windowElement:w(a,c,h,v)}).axis,isWindow:P(i=n.windowElement)},i),S=new E({totalToScroll:_(h,y)}),O={up:e.upDistance,down:e.downDistance},(o={container:y.container,throttle:e.throttle},r=Object(s.a)(o.container,"scroll"),o.throttle&&(r=r.pipe(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b;return function(i){return i.lift(new m(t,e,n.leading,n.trailing))}}(o.throttle))),r).pipe(Object(u.a)(function(){return Object(l.a)(_(h,y))}),Object(f.a)(function(t){return function(t,e,n){var i=function(t,e,n){var i=function(t,e){return t<e.scrolled}(t,e);return{fire:j(e,n,i),scrollDown:i}}(t,e,n);return{scrollDown:i.scrollDown,fire:i.fire,stats:e}}(S.lastScrollPosition,t,O)}),Object(d.a)(function(t){var e=t.stats;return S.updateScroll(e.scrolled,e.totalToScroll)}),Object(p.a)(function(t){var n=t.fire,i=t.scrollDown,o=t.stats.totalToScroll;return function(t,e,n){return!(!t||!e)||!(n||!e)}(e.alwaysCallback,n,S.isTriggeredScroll(o,i))}),Object(d.a)(function(t){var e=t.scrollDown,n=t.stats.totalToScroll;S.updateTriggeredFlag(n,e)}),Object(f.a)(K))).subscribe(function(e){return t.zone.run(function(){return t.handleOnScroll(e)})})})}},{key:"handleOnScroll",value:function(t){var e=t.type,n=t.payload;switch(e){case"[NGX_ISE] DOWN":return this.scrolled.emit(n);case"[NGX_ISE] UP":return this.scrolledUp.emit(n);default:return}}},{key:"ngOnDestroy",value:function(){this.destroyScroller()}},{key:"destroyScroller",value:function(){this.disposeScroller&&this.disposeScroller.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||W)(r.Kb(r.l),r.Kb(r.A))},W.\u0275dir=r.Fb({type:W,selectors:[["","infiniteScroll",""],["","infinite-scroll",""],["","data-infinite-scroll",""]],inputs:{infiniteScrollDistance:"infiniteScrollDistance",infiniteScrollUpDistance:"infiniteScrollUpDistance",infiniteScrollThrottle:"infiniteScrollThrottle",infiniteScrollDisabled:"infiniteScrollDisabled",infiniteScrollContainer:"infiniteScrollContainer",scrollWindow:"scrollWindow",immediateCheck:"immediateCheck",horizontal:"horizontal",alwaysCallback:"alwaysCallback",fromRoot:"fromRoot"},outputs:{scrolled:"scrolled",scrolledUp:"scrolledUp"},features:[r.xb]}),W),F=((H=function t(){a(this,t)}).\u0275fac=function(t){return new(t||H)},H.\u0275mod=r.Ib({type:H}),H.\u0275inj=r.Hb({providers:[],imports:[[]]}),H)},xzSE:function(n,i,o){"use strict";o.d(i,"a",function(){return m});var r=o("fXoL"),l=o("yvDh"),s=o("XNvU"),u=o("tyNb"),f=o("ofXK"),d=o("3Pt+"),p=o("Sqts");function h(t,e){if(1&t&&r.Lb(0,"img",19),2&t){var n=r.Yb();r.dc("src",n.me.avatarPath,r.mc)}}function g(t,e){1&t&&r.Lb(0,"img",20)}function b(t,e){if(1&t){var n=r.Qb();r.Pb(0,"div",21),r.Pb(1,"div",22),r.Pb(2,"div",23),r.Wb("click",function(){return r.lc(n),r.Yb().unPreviewImages()}),r.Ob(),r.Lb(3,"app-photos-container",24),r.Ob(),r.Ob()}if(2&t){var i=r.Yb();r.zb(3),r.dc("photos",i.previewFiles)}}var m=function(){var n=function(){function n(t,e,i){a(this,n),this.postsService=t,this.mediaService=e,this.router=i,this.newPostEvent=new r.n,this.isValid=!1,this.previewFiles=[],this.subs=[],this.postForm={text:"",images:[]}}return c(n,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.subs.forEach(function(t){console.log("unsubs"),t.unsubscribe()})}},{key:"resizeTextarea",value:function(t){var e=t.target;e.style.height="auto",e.style.height=e.scrollHeight+"px"}},{key:"onEnterSubmit",value:function(t,e){"Enter"!=e.key||e.shiftKey||(e.preventDefault(),this.onSubmit(t))}},{key:"onSubmit",value:function(e){var n=this,i={text:this.postForm.text,mediaDTOs:[]};if(0!=this.postForm.images.length){var o=new FormData;t(this.postForm.images).forEach(function(t,e){o.set("file"+e,t,t.name)}),this.mediaService.uploadMedia(o).subscribe(function(t){i.mediaDTOs=t,console.log(t),n.subs.push(n.postsService.savePost(i).subscribe(function(t){n.newPostEvent.emit(t)})),n.previewFiles=[]})}else this.postForm.text&&this.subs.push(this.postsService.savePost(i).subscribe(function(t){n.newPostEvent.emit(t)}));this.postForm={text:"",images:[]}}},{key:"previewImages",value:function(t){var n=this;this.postForm.images=t,this.previewFiles=[];var i,o=function(t,n){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=e(t))||n&&t&&"number"==typeof t.length){i&&(t=i);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,a=!0,s=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return a=t.done,t},e:function(t){s=!0,l=t},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw l}}}}(t);try{var r=function(){var t=i.value;if(t.type.match("image*")){var e=new FileReader;e.onload=function(e){n.previewFiles.push({id:t.name,mimeType:t.type,path:e.target.result.toString(),size:t.size,creationDate:new Date(t.lastModified)})},e.readAsDataURL(t)}};for(o.s();!(i=o.n()).done;)r()}catch(l){o.e(l)}finally{o.f()}}},{key:"unPreviewImages",value:function(t){this.postForm.images=[],this.previewFiles=[]}}]),n}();return n.\u0275fac=function(t){return new(t||n)(r.Kb(s.a),r.Kb(l.a),r.Kb(u.b))},n.\u0275cmp=r.Eb({type:n,selectors:[["app-post-maker"]],inputs:{me:"me"},outputs:{newPostEvent:"newPostEvent"},decls:21,vars:5,consts:[[1,"post-maker","flex","fd-r","jc-sb","ai-fs"],[1,"avatar-box","square-48"],["class","square-48","alt","photo",3,"src",4,"ngIf","ngIfElse"],["default_avatar",""],[3,"ngSubmit"],["form","ngForm"],["rows","1","name","postText","placeholder","\u0429\u043e \u043d\u043e\u0432\u043e\u0433\u043e?",3,"ngModel","input","ngModelChange"],["class","flex jc-c",4,"ngIf"],[1,"post-maker-footer","flex","ai-fe","jc-sb"],[1,"attach","flex","fd-r","jc-sb"],[1,"add-picture-btn","round","r-20","square-28",3,"click"],["type","file","name","postImages","ngModel","","multiple","",1,"hidden",3,"change"],["input_image",""],[1,"add-music-btn","round","r-20","square-28"],["type","file","name","music",1,"hidden"],[1,"add-video-btn","round","r-22","square-28"],["type","file","name","video",1,"hidden"],[1,"add-emoji-btn","round","r-22","square-28"],["type","submit",1,"submit-btn",3,"disabled"],["alt","photo",1,"square-48",3,"src"],["src","../../../../assets/images/default-avatar.jpg","alt","default-avatar",1,"square-48"],[1,"flex","jc-c"],[1,"preview-container","fg-1"],[1,"close-btn","round","r-16","square-20",3,"click"],["size","large",3,"photos"]],template:function(t,e){if(1&t){var n=r.Qb();r.Pb(0,"section",0),r.Pb(1,"span",1),r.oc(2,h,1,1,"img",2),r.oc(3,g,1,0,"ng-template",null,3,r.pc),r.Ob(),r.Pb(5,"form",4,5),r.Wb("ngSubmit",function(){r.lc(n);var t=r.kc(6);return e.onSubmit(t)}),r.Pb(7,"textarea",6),r.Wb("input",function(t){return e.resizeTextarea(t)})("ngModelChange",function(t){return e.postForm.text=t}),r.Ob(),r.oc(8,b,4,1,"div",7),r.Pb(9,"div",8),r.Pb(10,"ul",9),r.Pb(11,"li",10),r.Wb("click",function(){return r.lc(n),r.kc(13).click()}),r.Pb(12,"input",11,12),r.Wb("change",function(){r.lc(n);var t=r.kc(13);return e.previewImages(t.files)}),r.Ob(),r.Ob(),r.Pb(14,"li",13),r.Lb(15,"input",14),r.Ob(),r.Pb(16,"li",15),r.Lb(17,"input",16),r.Ob(),r.Lb(18,"li",17),r.Ob(),r.Pb(19,"button",18),r.qc(20,"\u041e\u043f\u0443\u0431\u043b\u0456\u043a\u0443\u0432\u0430\u0442\u0438"),r.Ob(),r.Ob(),r.Ob(),r.Ob()}if(2&t){var i=r.kc(4);r.zb(2),r.dc("ngIf",e.me.avatarPath)("ngIfElse",i),r.zb(5),r.dc("ngModel",e.postForm.text),r.zb(1),r.dc("ngIf",e.previewFiles.length>0),r.zb(11),r.dc("disabled",!e.postForm.text&&0==e.postForm.images.length)}},directives:[f.k,d.p,d.i,d.j,d.a,d.h,d.k,p.a],styles:[".post-maker[_ngcontent-%COMP%]{margin:15px 0 10px;padding:12px 16px;border-radius:15px;color:#272727;background:#fff}.post-maker[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{flex-basis:624px}.post-maker[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{margin-top:14px;font-size:18px;height:22px}.post-maker[_ngcontent-%COMP%]   .media-box[_ngcontent-%COMP%]{max-height:420px;border-radius:15px;overflow:hidden;margin:15px 0}.post-maker[_ngcontent-%COMP%]   .media-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:cover;object-fit:cover;-o-object-position:center;object-position:center;width:40%;max-height:210px;flex-grow:1;margin:0 2px 2px 0}.post-maker[_ngcontent-%COMP%]   .media-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:first-of-type{max-height:420px}.post-maker[_ngcontent-%COMP%]   .avatar-box[_ngcontent-%COMP%]{margin-right:10px;background:#eee}.post-maker[_ngcontent-%COMP%]   .post-maker-footer[_ngcontent-%COMP%]{flex-grow:1}.post-maker[_ngcontent-%COMP%]   .post-maker-footer[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]{border:none;color:#fff;padding:8px 11px;border-radius:20px;font-weight:700;font-size:15px;outline:none;cursor:pointer;background-color:#3eb2fa}.post-maker[_ngcontent-%COMP%]   .post-maker-footer[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]:disabled{background-color:#a7d9f8;cursor:auto}.attach[_ngcontent-%COMP%]{list-style:none}.attach[_ngcontent-%COMP%]   .add-picture-btn[_ngcontent-%COMP%]{background-image:url(picture.8bab62ef09da605e0ddf.png)}.attach[_ngcontent-%COMP%]   .add-music-btn[_ngcontent-%COMP%]{background-image:url(add-music.9a4176a08125a911c279.png)}.attach[_ngcontent-%COMP%]   .add-video-btn[_ngcontent-%COMP%]{background-image:url(add-video.07c28269d0df8adddcda.png)}.attach[_ngcontent-%COMP%]   .add-emoji-btn[_ngcontent-%COMP%]{position:relative;background-image:url(emoji.a281a630f75958ce1961.png)}.preview-container[_ngcontent-%COMP%]{position:relative;margin:5px 0}.preview-container[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{position:absolute;right:5px;top:5px;background-image:url(plus-hover.c5a44e580f069dae6603.png);background-color:#fff;transform:rotate(45deg);border:1px solid #eee;outline:none;z-index:10}"]}),n}()}}])}();